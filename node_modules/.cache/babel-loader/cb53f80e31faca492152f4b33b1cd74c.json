{"ast":null,"code":"import _regeneratorRuntime from\"C:/coding/project2/cloudproject2/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/coding/project2/cloudproject2/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/coding/project2/cloudproject2/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useNavigate}from'react-router-dom';import React,{useState}from\"react\";import{Header}from'./Header';import'./App.css';import Axios from'axios';import{useAuth0}from\"@auth0/auth0-react\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var api_url=\"http://54.160.173.1:38080/\";function Main(){var navigate=useNavigate();// var image_height;\n// var image_width; \nvar _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),image=_useState2[0],setimage=_useState2[1];var _useAuth=useAuth0(),user=_useAuth.user,isAuthenticated=_useAuth.isAuthenticated,isLoading=_useAuth.isLoading,logout=_useAuth.logout;var formdata=new FormData();formdata.append(\"image\",image);var upload=function upload(){var img=new Image();img.src=window.URL.createObjectURL(image);img.onload=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var image_height,image_width,image_size,image_type,image_name;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:image_height=img.naturalHeight;image_width=img.naturalWidth;image_size=image.size;image_type=image.type;image_name=image.name;window.URL.revokeObjectURL(img.src);if(image_height>200){alert(\"Dimention of height over 200px\");}else if(image_width>200){alert(\"Dimention of width over 200px \");}else if(image_size>=51200){alert(\"this file is size over 50KB\");}else if(image_type!=\"image/jpeg\"){alert(\"this file isn't a jpg\");}else{fetch(\"https://8xfxl0fcfc.execute-api.us-east-1.amazonaws.com/upload\",{method:\"PUT\",body:JSON.stringify({users:user.email,name:image_name})}).then(function(res){return res.json();}).then(function(data){console.log(data);//put binary data to s3\nfetch(\"https://9e3j2pj15i.execute-api.us-east-1.amazonaws.com/api/image-cloud-p/\"+image_name,{method:\"PUT\",body:image}).then(function(res){return res.json();}).then(function(data){console.log(data);});}).catch(function(err){console.log(err);});}case 7:case\"end\":return _context.stop();}}},_callee);}));};return/*#__PURE__*/_jsxs(\"div\",{className:\"body1 \",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"header\",children:\"Main\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",onChange:function onChange(e){return setimage(e.target.files[0]);}}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"button\",{onClick:upload,children:\"upload\"}),\"  \",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return logout({returnTo:window.location.origin});},children:\"\\u0E2D\\u0E2D\\u0E01\\u0E08\\u0E32\\u0E01\\u0E23\\u0E30\\u0E1A\\u0E1A\"})]});}export default Main;","map":{"version":3,"names":["useNavigate","React","useState","Header","Axios","useAuth0","api_url","Main","navigate","image","setimage","user","isAuthenticated","isLoading","logout","formdata","FormData","append","upload","img","Image","src","window","URL","createObjectURL","onload","image_height","naturalHeight","image_width","naturalWidth","image_size","size","image_type","type","image_name","name","revokeObjectURL","alert","fetch","method","body","JSON","stringify","users","email","then","res","json","data","console","log","catch","err","e","target","files","returnTo","location","origin"],"sources":["C:/coding/project2/cloudproject2/src/Main.js"],"sourcesContent":["import { useNavigate } from 'react-router-dom'\r\nimport React, { useState } from \"react\";\r\nimport { Header } from './Header'\r\nimport './App.css';\r\nimport Axios from 'axios';\r\nimport { useAuth0 } from \"@auth0/auth0-react\";\r\n\r\n\r\nconst api_url = \"http://54.160.173.1:38080/\"\r\n\r\nfunction Main() {\r\n    let navigate = useNavigate()\r\n\r\n    // var image_height;\r\n    // var image_width; \r\n\r\n    const [image, setimage] = useState(\"\");\r\n    const { user, isAuthenticated, isLoading,logout } = useAuth0();\r\n\r\n    var formdata = new FormData()\r\n\r\n    formdata.append(\"image\", image)\r\n\r\n\r\n\r\n    const upload = () => {\r\n\r\n        var img = new Image()\r\n\r\n        img.src = window.URL.createObjectURL(image)\r\n\r\n        img.onload = async function () {\r\n\r\n            const image_height = img.naturalHeight\r\n            const image_width = img.naturalWidth\r\n            const image_size = image.size\r\n            const image_type = image.type\r\n            const image_name = image.name\r\n\r\n            window.URL.revokeObjectURL(img.src)\r\n\r\n            if (image_height > 200) {\r\n                alert(\"Dimention of height over 200px\")\r\n            }\r\n\r\n            else if (image_width > 200) {\r\n                alert(\"Dimention of width over 200px \")\r\n            }\r\n\r\n            else if (image_size >= 51200) {\r\n                alert(\"this file is size over 50KB\")\r\n            }\r\n\r\n            else if (image_type != \"image/jpeg\") {\r\n                alert(\"this file isn't a jpg\")\r\n            }\r\n            else {\r\n                fetch(\"https://8xfxl0fcfc.execute-api.us-east-1.amazonaws.com/upload\", {\r\n                method: \"PUT\",\r\n                body: JSON.stringify({\r\n                    users: user.email,\r\n                    name: image_name,\r\n                }),\r\n            })\r\n                .then(res => res.json())\r\n                .then(data => {\r\n                    console.log(data);\r\n\r\n                    //put binary data to s3\r\n                    fetch(\"https://9e3j2pj15i.execute-api.us-east-1.amazonaws.com/api/image-cloud-p/\" + image_name, {\r\n                        method: \"PUT\",\r\n                        body: image\r\n                    })\r\n                        .then(res => res.json())\r\n                        .then(data => {\r\n                            console.log(data);\r\n                        }\r\n                        )\r\n                })\r\n                .catch(err => {\r\n                    console.log(err);\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    return (\r\n\r\n        <div className='body1 '>\r\n            <h1 className='header'>Main</h1>\r\n            <br></br>\r\n            <input type={\"file\"} onChange={(e) => setimage(e.target.files[0])} ></input><br></br><br></br>\r\n            <button onClick={(upload)}>upload</button>  <br></br><br></br>\r\n            <button onClick={() => logout({ returnTo: window.location.origin })}>ออกจากระบบ</button>\r\n        </div>\r\n    )\r\n}\r\nexport default Main;"],"mappings":"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"},"metadata":{},"sourceType":"module"}